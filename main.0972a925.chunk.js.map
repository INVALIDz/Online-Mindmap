{"version":3,"sources":["statics/refer.js","context/reducer/mindmap/actionTypes.js","customHooks/useMindmap.js","context/reducer/global/actionTypes.js","components/Popup/common/styledComponents.js","context/reducer/nodeStatus/actionCreator.js","context/reducer/mindmap/actionCreator.js","context/reducer/nodeStatus/actionTypes.js","../node_modules/express/lib sync","context/reducer/history/actionTypes.js","customHooks/node.js","methods/assistFunctions.js","context/reducer/global/actionCreator.js","customHooks/useTheme.js","features/ThemeProvider/index.js","customHooks/useHistory.js","customHooks/useZoom.js","customHooks/useMove.js","components/ToolButton/index.js","components/MindmapTitle/index.js","components/Popup/subComponents/New.js","methods/mindmapParser.js","components/Popup/subComponents/Open.js","components/Popup/subComponents/Theme/ThemeListItem.js","components/Popup/subComponents/Theme/index.js","components/Popup/index.js","components/Popup/common/popupType.js","features/Nav/index.js","methods/getKeydownEvent.js","methods/getMouseWheelEvent.js","context/reducer/editPanel/actionCreator.js","customHooks/useEditPanel.js","components/Node/subComponents/Toolbar.js","components/Node/subComponents/InputDiv.js","components/mdPreview/index.js","components/Node/index.js","components/SubNode/index.js","components/RootNode/index.js","methods/drawCanvas.js","methods/getDragEvents.js","components/DragCanvas/index.js","components/LineCanvas/index.js","features/Mindmap/index.js","components/mdEditor/index.js","features/EditPanel/index.js","features/Main/index.js","App.js","serviceWorker.js","index.js","statics/defaultMindmap.js","context/reducer/editPanel/actionTypes.js","context/reducer/mindmap/index.js","context/reducer/nodeStatus/index.js","context/reducer/history/index.js","context/reducer/global/index.js","context/reducer/editPanel/index.js","context/index.js","context/reducer/history/actionCreator.js"],"names":["__webpack_require__","d","__webpack_exports__","LEFT_NODE","RIGHT_NODE","DROP_AREA","ROOT_PARENT","ROOT_NODE_ID","MINDMAP_ID","MINDMAP_MAIN","NEW_NODE_TEXT","DEFAULT_TITLE","THEME_MAIN","THEME_LIGHT","THEME_DARK","THEME_EX","THEME_ASSIST","id","children","TOGGLE_CHILDREN","ADD_CHILD","ADD_SIBLING","MOVE_NODE","CHANGE_TEXT","DELETE_NODE","EXPAND_ALL","SET_MINDMAP","react__WEBPACK_IMPORTED_MODULE_0__","_context__WEBPACK_IMPORTED_MODULE_1__","_context_reducer_mindmap_actionCreator__WEBPACK_IMPORTED_MODULE_2__","_context_reducer_nodeStatus_actionCreator_js__WEBPACK_IMPORTED_MODULE_3__","_context_reducer_history_actionCreator__WEBPACK_IMPORTED_MODULE_4__","md5__WEBPACK_IMPORTED_MODULE_5__","md5__WEBPACK_IMPORTED_MODULE_5___default","n","mongoose","require","app","express","Point","console","dir","connect","useNewUrlParser","useCreateIndex","useUnifiedTopology","useMindmap","_useContext","useContext","context","mDispatch","mindmap","dispatch","nDispatch","nodeStatus","hDispatch","history","toggleChildren","node_id","bool","mindmapAction","addChild","new_node_id","md5","Date","now","Math","random","nodeStatusAction","newnode","title","parent","Children","log","save","addSibling","parent_id","moveNode","target_id","is_sibling","editNode","changeText","text","editNodeInfo","info","selectNode","select_by_click","deleteNode","clearNodeStatus","setMindmap","is_new_map","clearHistory","expandAll","SET_TITLE","SET_THEME","ZOOM_IN","ZOOM_OUT","ZOOM_RESET","MOVE_XY","MOVE_RESET","MOVE_XY_WHEN_ZOOM","ButtonSet","props","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","Object","assign","className","css","_templateObject","MainButton","_templateObject2","refer","Highlight","_templateObject3","Annotation","_templateObject4","Shortcut","_templateObject5","setSelect","type","actionTypes","data","cur_select","cur_edit","cur_node_info","setEdit","clearAll","getNodeInfo","node","on_left","C_Users_12240_Downloads_RMind_develop_RMind_develop_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","changeInfo","_actionTypes__WEBPACK_IMPORTED_MODULE_0__","_statics_refer__WEBPACK_IMPORTED_MODULE_1__","showChildren","SET_SELECT","SET_EDIT","GET_NODE_INFO","CLEAR_ALL","webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","SET_HISTORY","CLEAR_HISTORY","NodeSchema","Schema","String","model","handlePropagation","event","stopPropagation","deepCopy","input","Array","isArray","map","output","entries","forEach","_ref","_ref2","C_Users_12240_Downloads_RMind_develop_RMind_develop_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","key","value","findNode","search_id","child","find","item","setShowChildrenTrue","downloadFile","url","filename","link","document","href","download","click","debounce","func","wait","timer","_this","this","_arguments","arguments","clearTimeout","setTimeout","apply","setTitle","useTheme","_useContext$global","global","_useContext$global$st","state","theme_index","theme_list","theme","useMemo","setTheme","index","ThemeProvider","react_default","main","light","assist","dark","ex","useHistory","applySnapshot","snapshot","cur_node","JSON","parse","undoHistory","undo","length","redoHistory","redo","useZoom","gDispatch","zoomIn","x","y","globalAction","zoomOut","zoomReset","zoomRate","useMove","moveXY","moveReset","ToolButton","icon","onClick","disabled","cx","wrapper","defineProperty","disabled_style","ToolButton_templateObject","MindmapTitle","self","useRef","useEffect","concat","localStorage","setItem","ref","contentEditable","suppressContentEditableWarning","spellCheck","onKeyDown","toUpperCase","current","textContent","blur","onBlur","new_title","trim","slice","MindmapTitle_templateObject","New","handleClosePopup","handleDownload","styledComponents","defaultMindmap","getLayerAndText","line","format","layer","match","replace","buildNodeFromJSON","json","copyNodeData","target_node","source_node","is_root_node","expandState","root","mindmapParser","import_data","buildNodeFromText","data_array","cur_layer","cur_text","undefined","root_data","shift","_getLayerAndText","push","split","filter","Open","sub_title","list_wrapper","accept","addEventListener","file","target","files","file_name","name","dot_index","file_reader","FileReader","onload","str","result","alert","readAsText","Open_templateObject","Open_templateObject2","ThemeListItem","is_current","current_style","style","backgroundColor","ThemeListItem_templateObject","ThemeListItem_templateObject2","Theme","_useTheme","Theme_ThemeListItem","Theme_templateObject","Popup","Content","lazy","Promise","all","then","bind","getContentComponent","content_wrapper","close_button","react","fallback","Fragment","overlay","Popup_templateObject","Popup_templateObject2","Nav","_useState","useState","_useState2","slicedToArray","popup","setPopup","_useZoom","_useMove","_useHistory","encodeURIComponent","stringify","handleZoom","zoom","handleMove","move","section","components_ToolButton","components_MindmapTitle","components_Popup","Nav_templateObject","Nav_templateObject2","getKeydownEvent","mindmapHook","historyHook","navigator","platform","startsWith","metaKey","ctrlKey","shiftKey","preventDefault","trunc","cur_index","findIndex","handleKeyEventWithNode","mousemoveInfo","startX","startY","getMouseWheelEvent","propHook","normalizeXY","wheelDelta","getWheelDelta","clientX","clientY","buttons","altKey","movedX","movedY","handleWhellEventWithkey","toggelPanelShow","isShow","useEditPanel","_useContext$editPanel","editPanel","epState","epDispatch","editPanelAction","savePanel","Toolbar","editPanelHook","Toolbar_templateObject","InputDiv","_useMindmap","focus","getSelection","selectAllChildren","InputDiv_templateObject","marked","setOptions","renderer","Renderer","highlight","hljs","highlightAuto","pedantic","gfm","breaks","sanitize","smartLists","smartypants","xhtml","MdPreview","_props$mdtext","mdtext","querySelectorAll","block","highlightBlock","fontSize","dangerouslySetInnerHTML","__html","Node","node_refs","_useContext$nodeStatu","add","delete","scrollIntoView","behavior","inline","common_style","specific_style","seleted_style","draggable","data-tag","data-parent","data-show-children","subComponents_InputDiv","drop_area","onDoubleClick","components_mdPreview","toggle_button","button_left","button_right","subComponents_Toolbar","style_selected_border","Node_templateObject","Node_templateObject2","Node_templateObject3","Node_templateObject4","_templateObject6","_templateObject7","_templateObject8","_templateObject9","_templateObject10","SubNode","left_style","components_Node","sub_node","SubNode_templateObject","SubNode_templateObject2","RootNode","root_node","total","half","components_SubNode","RootNode_templateObject","drawBezier","ctx","from_x","from_y","to_x","to_y","moveTo","bezierCurveTo","drawLineCanvas","beginPath","lineWidth","strokeStyle","drawLine","_map$get","get","_map$get2","parent_x_left","parent_x_right","parent_y","child_data","_child_data","child_x_left","child_x_right","child_y","stroke","closePath","drawDragCanvas","child_id","parent_offset","child_offset","child_left_of_parent","setLineDash","parent_x","child_x","top","bottom","left","right","strokeRect","virtual_rect_height","getDomOffset","dom","offsetLeft","offsetWidth","offsetTop","offsetHeight","getDragEvents","drag_canvas","container","drag","children_offset_left","children_offset_right","children_offset_vertical","parent_is_root","container_left","container_top","container_width","container_height","in_drop_area","handleContainerScroll","scrollLeft","scrollTop","listener","dataset","tag","getElementById","children_offset","each","min","toConsumableArray","offset","max","reduce","flat_arr","cur","getContext","clearRect","width","height","moveX","moveY","mouse_x","mouse_y","i","last_index","j","parentNode","classList","remove","removeEventListener","DragCanvas","parent_ref","container_ref","flag","setFlag","gState","handleWindowResize","window","handleDrag","querySelector","DragCanvas_templateObject","LineCanvas","Map","from","LineCanvas_templateObject","Set","Mindmap","zoomHook","moveHook","FLAG","setFLAG","mindmap_json","handleResize","handleKeydown","clientWidth","clientHeight","handleMouseWheel","handleMapMove","setHistory","components_RootNode","components_DragCanvas","components_LineCanvas","Mindmap_templateObject","MdEditor","propText","setText","textarea","onChange","resize","EditPanel","_nState$cur_node_info","_nState$cur_node_info2","editPanleHook","show","close","mdEditor","EditPanel_templateObject","position","cursor","EditPanel_templateObject2","Main","features_Mindmap","features_EditPanel","Main_templateObject","App","features_ThemeProvider","features_Nav","features_Main","Boolean","location","hostname","ReactDOM","render","src_App","serviceWorker","ready","registration","unregister","_refer__WEBPACK_IMPORTED_MODULE_0__","TOGGLE_PANEL_SHOW","defaultValue_mindmap","getItem","reducer_mindmap","action","new_mindmap","node_found","insert_index","splice","node_index","node_copy","target_index","delete_index","defaultValue_nodeStatus","reducer_nodeStatus","objectSpread","defaultValue_history","last_snapshot","reducer_history","new_history","unshift","pop","defaultValue_global","Number","reducer_global","newGlobal","obj","defaultValue_editPanel","nodeId","panel","newPanel","React","createContext","WrappedProvider","_useReducer","useReducer","mindmapReducer","_useReducer2","mState","_useReducer3","nodeStatusReducer","_useReducer4","nState","_useReducer5","historyReducer","_useReducer6","hState","_useReducer7","globalReducer","_useReducer8","_useReducer9","editPanelReducer","_useReducer10","combined","Provider"],"mappings":"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","file":"static/js/main.0972a925.chunk.js","sourcesContent":["// Node Type\nexport const LEFT_NODE = 'nodeLeft';\nexport const RIGHT_NODE = 'nodeRight';\nexport const DROP_AREA = 'dropArea';\n\n// DOM 操作相关\nexport const ROOT_PARENT = {id: '', children: []};\nexport const ROOT_NODE_ID = 'rmind_root_node';\nexport const MINDMAP_ID = 'rmind_mindmap_wrapper';\nexport const MINDMAP_MAIN = 'rmind_main'\n\n// 缺省文本\nexport const NEW_NODE_TEXT = '新建节点';\nexport const DEFAULT_TITLE = '未命名导图';\n\n// CSS 主题变量名\nexport const THEME_MAIN = '--theme-main';\nexport const THEME_LIGHT = '--theme-light';\nexport const THEME_DARK = '--theme-dark';\nexport const THEME_EX = '--theme-ex';\nexport const THEME_ASSIST = '--theme-assist';","export const TOGGLE_CHILDREN = 'mindmap/toggleChildren';\nexport const ADD_CHILD = 'mindmap/addChild';\nexport const ADD_SIBLING = 'mindmap/addSibling';\nexport const MOVE_NODE = 'mindmap/moveNode';\nexport const CHANGE_TEXT = 'mindmap/changeText';\nexport const DELETE_NODE = 'mindmap/deleteNode';\nexport const EXPAND_ALL = 'mindmap/expandAll';\nexport const SET_MINDMAP = 'mindmap/setMindmap';","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as mindmapAction from '../context/reducer/mindmap/actionCreator';\nimport * as nodeStatusAction from '../context/reducer/nodeStatus/actionCreator.js';\nimport {clearHistory} from '../context/reducer/history/actionCreator';\nimport md5 from 'md5';\nconst mongoose=require(\"mongoose\")\nconst express=require(\"express\")\nconst app=express()\nconst Point=require('./node')\nconsole.dir(app)\nmongoose.connect('mongodb://localhost:27017/MindMap',{useNewUrlParser:true,useCreateIndex:true, useUnifiedTopology:true})\n\nconst useMindmap = () => {\n    const {mindmap: {dispatch: mDispatch}, nodeStatus: {dispatch: nDispatch}, history: {dispatch: hDispatch}} = useContext(context);\n    return {\n        toggleChildren: (node_id, bool) => {\n            mDispatch(mindmapAction.toggleChildren(node_id, bool));\n        },\n        addChild: node_id => {\n            const new_node_id = md5('' + Date.now() + Math.random());\n            mDispatch(mindmapAction.toggleChildren(node_id, true));\n            mDispatch(mindmapAction.addChild(node_id, new_node_id));\n            nDispatch(nodeStatusAction.setEdit(new_node_id));\n            const newnode=new Point({title:new_node_id,parent:node_id,Children:[\"null\"]})\n            console.log(\"Saving\")\n            newnode.save();\n        },\n        addSibling: (node_id, parent_id) => {\n            const new_node_id = md5('' + Date.now() + Math.random());\n            mDispatch(mindmapAction.addSibling(node_id, parent_id, new_node_id));\n            nDispatch(nodeStatusAction.setEdit(new_node_id));\n        },\n        moveNode: (node_id, target_id, parent_id, is_sibling) => {\n            mDispatch(mindmapAction.moveNode(node_id, target_id, parent_id, is_sibling));\n            nDispatch(nodeStatusAction.setSelect(node_id));\n        },\n        editNode: node_id => {\n            nDispatch(nodeStatusAction.setEdit(node_id));\n        },\n        changeText: (node_id, text) => {\n            mDispatch(mindmapAction.changeText(node_id, text));\n        },\n        editNodeInfo:(node_id,info)=>{\n            mDispatch(mindmapAction.changeInfo(node_id, info));                      \n          },\n        selectNode: (node_id, select_by_click) => {\n            nDispatch(nodeStatusAction.setSelect(node_id, select_by_click));\n        },\n        deleteNode: (node_id, parent_id) => {\n            mDispatch(mindmapAction.deleteNode(node_id, parent_id));\n            nDispatch(nodeStatusAction.setSelect(parent_id));\n        },\n        clearNodeStatus: () => {\n            nDispatch(nodeStatusAction.clearAll());\n        },\n        setMindmap: (mindmap, is_new_map) => {\n            if (is_new_map) {\n                hDispatch(clearHistory());\n                nDispatch(nodeStatusAction.setSelect(mindmap.id));\n            }\n            mDispatch(mindmapAction.setMindmap(mindmap));\n        },\n        expandAll: node_id => {\n            mDispatch(mindmapAction.expandAll(node_id));\n            nDispatch(nodeStatusAction.setSelect(node_id));\n        }\n    }\n};\n\nexport default useMindmap;","export const SET_TITLE = 'global/setTitle';\nexport const SET_THEME = 'global/setTheme';\nexport const ADD_THEME = 'global/addTheme'; /// 主题增删改，将来实现\n\nexport const ZOOM_IN = 'global/zoomIn';\nexport const ZOOM_OUT = 'global/zoomOut';\nexport const ZOOM_RESET= 'global/zoomReset';\n\nexport const MOVE_XY= 'global/moveXY';\nexport const MOVE_RESET= 'global/moveReset';\nexport const MOVE_XY_WHEN_ZOOM= 'global/moveXYWhenZoom';\n","import React from 'react';\nimport {css} from 'emotion';\nimport * as refer from '../../../statics/refer';\n\nexport const ButtonSet = props => (<div {...props} className={css`\ndisplay: flex;\njustify-content: flex-end;\nmargin-top: 20px;\n\nbutton {\nmargin-left: 20px;\npadding: 10px 20px;\nbackground-color: #ffffff;\nborder-radius: 10px;\noutline: none;\n}\n\nbutton:active {\ntransform: scale(0.95);\n}\n`} />);\n\nexport const MainButton = props => (<button {...props} className={css` /* button& 用于提高 CSS 权重 */\nbutton& {\ncolor: #ffffff;\nbackground-color: var(${refer.THEME_DARK});\nborder: 1px solid var(${refer.THEME_MAIN});\n}\n`} />);\n\nexport const Highlight = props => (<p {...props} className={css`\nmargin-top: 0;\ncolor: var(${refer.THEME_ASSIST});\nfont-weight: 700;\n`} />);\n\nexport const Annotation = props => (<p {...props} className={css`\ncolor: #888888;\nfont-size: 90%;\n`} />);\n\nexport const Shortcut = props => (<a {...props} className={css`\ntext-decoration: underline;\ncursor: pointer;\n`} />);","import * as actionTypes from './actionTypes';\n\nexport const setSelect = (node_id, select_by_click) => ({\n    type: actionTypes.SET_SELECT,\n    data: {\n        cur_select: node_id,\n        select_by_click: select_by_click || false,\n        cur_edit: '',\n        cur_node_info: {}\n    }\n});\n\nexport const setEdit = node_id => ({\n    type: actionTypes.SET_EDIT,\n    data: {\n        cur_select: '',\n        cur_edit: node_id,\n        cur_node_info: {}\n    }\n});\n\nexport const clearAll = () => ({\n    type: actionTypes.CLEAR_ALL,\n    data: {\n        cur_select: '',\n        select_by_click: false,\n        cur_edit: '',\n        cur_node_info: {}\n    }\n});\n\nexport const getNodeInfo = (node, parent, on_left) => ({\n    type: actionTypes.GET_NODE_INFO,\n    data: {\n        cur_node_info: {\n            ...node,\n            parent,\n            on_left\n        }\n    }\n});\n","import * as actionTypes from './actionTypes';\nimport {NEW_NODE_TEXT} from '../../../statics/refer';\n\nexport const toggleChildren = (node_id, bool) => ({\n    type: actionTypes.TOGGLE_CHILDREN,\n    data: {\n        node_id,\n        node: {\n            showChildren: bool\n        }\n    }\n});\n\nexport const addChild = (node_id, new_node_id) => ({\n    type: actionTypes.ADD_CHILD,\n    data: {\n        node_id,\n        node: {\n            id: new_node_id,\n            text: NEW_NODE_TEXT,\n            showChildren: true,\n            children: []\n        }\n    }\n});\n\nexport const addSibling = (node_id, parent_id, new_node_id) => ({\n    type: actionTypes.ADD_SIBLING,\n    data: {\n        node_id,\n        parent_id,\n        node: {\n            id: new_node_id,\n            text: NEW_NODE_TEXT,\n            showChildren: true,\n            children: []\n        }\n    }\n});\n\nexport const moveNode = (node_id, target_id, parent_id, is_sibling) => ({\n    type: actionTypes.MOVE_NODE,\n    data: {\n        node_id,\n        target_id,\n        parent_id,\n        is_sibling\n    }\n});\n\nexport const changeText = (node_id, text) => ({\n    type: actionTypes.CHANGE_TEXT,\n    data: {\n        node_id,\n        node: {\n            text\n        }\n    }\n});\n\nexport const changeInfo = (node_id, info) => ({\n    type: actionTypes.CHANGE_TEXT,\n    data: {\n        node_id,\n        node: {\n            info\n        }\n    }\n});\n\nexport const deleteNode = (node_id, parent_id) => ({\n    type: actionTypes.DELETE_NODE,\n    data: {\n        node_id,\n        parent_id\n    }\n});\n\nexport const expandAll = node_id => ({\n    type: actionTypes.EXPAND_ALL,\n    data: {\n        node_id\n    }\n});\n\nexport const setMindmap = mindmap => ({\n    type: actionTypes.SET_MINDMAP,\n    data: {\n        mindmap\n    }\n});\n","export const SET_SELECT = 'nodeStatus/setSelect';\nexport const SET_EDIT = 'nodeStatus/setEdit';\nexport const GET_NODE_INFO = 'nodeStatus/getNodeInfo';\nexport const CLEAR_ALL = 'nodeStatus/clearAll';","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 254;","export const SET_HISTORY = 'history/setHistory';\nexport const CLEAR_HISTORY = 'history/clearHistory';","const mongoose=require('mongoose')\r\nconst Schema =mongoose.Schema\r\nconst NodeSchema=new Schema({\r\n    title:String,\r\n    parent:String,\r\n    children:[String]\r\n})\r\nmodule.exports=mongoose.model(\"Point\",NodeSchema)","export const handlePropagation = event => {\n    event.stopPropagation();\n};\n\nexport const deepCopy = input => { // 简单的递归深拷贝，只考虑 context 中 state 的复制，因此没有处理 function 等\n    if (input instanceof Object) {\n        if (Array.isArray(input)) {\n            return input.map(deepCopy);\n        }\n        let output = {};\n        Object.entries(input).forEach(([key, value]) => {\n            output[key] = deepCopy(value);\n        });\n        return output;\n    }\n    return input;\n};\n\nexport const findNode = (node, search_id) => {\n    if (node.id === search_id) {\n        return node;\n    }\n    return node.children.map(child => findNode(child, search_id)).find(item => item);\n};\n\nexport const setShowChildrenTrue = node => {\n    node.showChildren = true;\n    node.children.forEach(setShowChildrenTrue);\n};\n\nexport const downloadFile = (url, filename) => {\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    link.click();\n};\n\nexport const debounce=(func,wait)=>{\n    let timer=null;\n    return function(){\n      if(timer) clearTimeout(timer);\n      timer=setTimeout(()=>{\n        // 绑定this的目的是，使得func的this指针保持普通,调用时候的指向\n        // argument也为调用debounce过后的func传入的参数\n        func.apply(this,arguments);\n      },wait)\n    }\n  \n  }","import * as actionTypes from './actionTypes';\n\nexport const setTitle = title => ({\n    type: actionTypes.SET_TITLE,\n    data: {\n        title\n    }\n});\n\nexport const setTheme = theme_index => ({\n    type: actionTypes.SET_THEME,\n    data: {\n        theme_index\n    }\n});\n\n\nexport const zoomIn = (x,y) => ({\n    type: actionTypes.ZOOM_IN,\n    data: {\n        x,y\n    }\n});\n\nexport const zoomOut = (x,y) => ({\n    type: actionTypes.ZOOM_OUT,\n    data: {\n        x,y\n    }\n});\n\nexport const zoomReset = zoomRate => ({\n    type: actionTypes.ZOOM_RESET,\n    data: {\n        zoomRate\n    }\n});\n\nexport const moveReset = () => ({\n    type: actionTypes.MOVE_RESET,\n    data: {\n    }\n});\n\nexport const moveXY = (x,y) => ({\n    type: actionTypes.MOVE_XY,\n    data: {\n        x,y\n    }\n});\n\nexport const moveXYWhenZoom = (x,y) => ({\n    type: actionTypes.MOVE_XY,\n    data: {\n        x,y\n    }\n});\n\n\n","import {useContext, useMemo} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\nexport default () => {\n    const {global: {state: {theme_index, theme_list}, dispatch}} = useContext(context);\n    const theme = useMemo(() => theme_list[theme_index], [theme_index]);\n    const setTheme = index => {\n        dispatch(globalAction.setTheme(index));\n    };\n\n    return {\n        theme,\n        theme_index,\n        theme_list,\n        setTheme\n    }\n}","import React from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../customHooks/useTheme';\nimport * as refer from '../../statics/refer';\n\nconst ThemeProvider = ({children}) => {\n    const {theme} = useTheme();\n\n    return (<div className={css`\n    ${refer.THEME_MAIN}: ${theme.main};\n    ${refer.THEME_LIGHT}: ${theme.light};\n    ${refer.THEME_ASSIST}: ${theme.assist};\n    ${refer.THEME_DARK}: ${theme.dark};\n    ${refer.THEME_EX}: ${theme.ex};\n    `}>\n        {children}\n    </div>);\n};\n\nexport default ThemeProvider;","import {useContext} from 'react';\nimport {context} from '../context';\nimport {setMindmap} from '../context/reducer/mindmap/actionCreator.js';\nimport {setSelect} from '../context/reducer/nodeStatus/actionCreator.js';\n\nexport default () => {\n    const {mindmap: {dispatch: mDispatch}, nodeStatus: {dispatch: nDispatch}, history: {state: history}} = useContext(context);\n\n    const applySnapshot = snapshot => {\n        if (snapshot) {\n            const {mindmap, cur_node} = snapshot;\n            mDispatch(setMindmap(JSON.parse(mindmap)));\n            nDispatch(setSelect(cur_node));\n        }\n    };\n\n    return {\n        undoHistory: () => {\n            applySnapshot(history.undo[history.undo.length - 1]);\n        },\n        redoHistory: () => {\n            applySnapshot(history.redo[0]);\n        }\n    }\n}\n\n","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\n\nconst useZoom = () => {\n    const {global: {dispatch: gDispatch}} = useContext(context);\n    return {\n        zoomIn: (x,y) => {\n            gDispatch(globalAction.zoomIn(x,y))          \n        },\n        zoomOut: (x,y) => {\n            gDispatch(globalAction.zoomOut(x,y))\n        },\n        zoomReset: () => {\n            gDispatch(globalAction.zoomReset())\n        },\n    }\n};\n\nexport default useZoom;","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\n\nconst useMove = () => {\n    const {global: {dispatch: gDispatch}} = useContext(context);\n    return {        \n        moveXY: (x,y) => {\n            gDispatch(globalAction.moveXY(x,y))\n        },\n        moveReset: () => {\n            gDispatch(globalAction.moveReset())\n        },\n    }\n};\n\nexport default useMove;","import React from 'react';\nimport {css, cx} from 'emotion';\nimport '../../statics/zwicon.css';\nimport * as refer from '../../statics/refer';\nimport {handlePropagation} from '../../methods/assistFunctions'; // 用于禁用按钮点击。如果使用 button 的 disable 属性实现，会由于点击事件冒泡导致 Toolbar 被隐藏\n\nconst ToolButton = ({icon, onClick, children, disabled}) => {\n    return (<button onClick={disabled ? handlePropagation : onClick} className={cx(wrapper, {[disabled_style]: disabled})}>\n            <i className={'zwicon-' + icon} />\n            <span>{children}</span>\n        </button>);\n};\n\nexport default ToolButton;\n\n// CSS\nconst wrapper = css`\nmargin: 0 0.12em;\npadding: 0 0.24em;\n/* margin 用于增加间隔，padding 用于增大可点击区域 */\nbackground-color: transparent;\nborder: none;\noutline: none;\ncursor: pointer;\n\ni {\ndisplay: block;\nmargin-bottom: 0.12em;\nfont-size: 100%;\n}\nspan {\ndisplay: block;\nfont-size: 25%;\n}\n\n&:active {\ntransform: scale(0.95);\n}\n\n&:hover {\ncolor: var(${refer.THEME_ASSIST});\n}\n`;\n\nconst disabled_style = css`\n&, &:hover {\ncolor: #cccccc;\n}\n\ncursor: not-allowed;\n`;","import React, {useEffect, useContext, useRef} from 'react';\nimport {css} from 'emotion';\nimport {context} from '../../context';\nimport {setTitle} from '../../context/reducer/global/actionCreator';\nimport * as refer from '../../statics/refer';\n\nconst MindmapTitle = () => {\n    const self = useRef();\n    const {global: {state: {title}, dispatch}} = useContext(context);\n\n    useEffect(() => {\n        document.title = `RMind - ${title}`;\n        localStorage.setItem('title', title);\n    }, [title]);\n\n    const handleKeydown = event => {\n        switch (event.key.toUpperCase()) {\n            case 'ESCAPE':\n                self.current.textContent = title;\n            case 'ENTER':\n                self.current.blur();\n                break;\n            default:\n                break;\n        }\n    };\n\n    const handleBlur = () => {\n        let new_title = self.current.textContent.trim();\n        if (new_title === '') {\n            new_title = title;\n        }\n        if (new_title.length > 30) {\n            new_title = new_title.slice(0, 30);\n        }\n        self.current.textContent = new_title; // contentEditable 组件内容不会被自动更新\n        dispatch(setTitle(new_title));\n    };\n\n    return (<span ref={self} className={wrapper} contentEditable=\"true\" suppressContentEditableWarning=\"true\"\n                  spellCheck=\"false\"\n                  onKeyDown={handleKeydown} onBlur={handleBlur}>{title}</span>);\n};\n\nexport default MindmapTitle;\n\n// CSS\nconst wrapper = css`\nalign-self: center;\npadding: 0 10px; /* 两侧 padding 用于增大组件点击区域，避免将光标定位至首尾处时意外 blur */\ncolor: var(${refer.THEME_DARK});\nfont-size: 20px;\nfont-weight: 700;\nborder-bottom: 2px solid transparent;\noutline: none;\ntransition: 0.2s;\n\n&:read-write {\ncursor: edit;\n}\n\n&:focus {\nborder-bottom: 2px solid var(${refer.THEME_ASSIST});\n}\n`;","import React, {useContext} from 'react';\nimport {context} from '../../../context';\nimport {setTitle} from '../../../context/reducer/global/actionCreator';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport defaultMindmap from '../../../statics/defaultMindmap';\nimport * as refer from '../../../statics/refer';\nimport {ButtonSet, MainButton, Shortcut, Highlight, Annotation} from '../common/styledComponents';\n\nconst New = ({handleClosePopup, handleDownload}) => {\n    const {global:{dispatch}} = useContext(context);\n    const {setMindmap} = useMindmap();\n\n    const handleNewFile = () => {\n        setMindmap(defaultMindmap, true);\n        dispatch(setTitle(refer.DEFAULT_TITLE));\n        handleClosePopup();\n    };\n\n    return (<div>\n        <Highlight>新建导图后，当前思维导图的数据将丢失。</Highlight>\n        <Annotation>要保存当前数据，请将思维导图<Shortcut onClick={handleDownload}>下载至本地</Shortcut>。</Annotation>\n        <ButtonSet>\n            <MainButton onClick={handleNewFile}>新建导图</MainButton>\n            <button onClick={handleClosePopup}>取消</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default New;","import md5 from 'md5';\nimport * as refer from '../statics/refer';\n\nconst getLayerAndText = (line, format) => {\n    let layer, text;\n    switch (format) {\n        case 'MD': {\n            if (line.match(/^#{1,6} /)) {\n                layer = line.match(/^#{1,6} /)[0].length - 2;\n                text = line.replace(/^#{1,6} /, '');\n            } else if (line.match(/^\\s*[-*] /)) {\n                layer = line.match(/^\\s*[-*] /)[0].length + 4;\n                text = line.replace(/^\\s*[-*] /, '');\n            }\n            return {layer, text};\n        }\n        case 'TXT': {\n            layer = line.match(/^\\s*/)[0].length;\n            text = line.replace(/^\\s*/, '');\n            return {layer, text};\n        }\n        default:\n            return {layer, text};\n    }\n};\n\nconst buildNodeFromText = (data_array, format, cur_layer, cur_text = '') => {\n    if (data_array.length === 0 && cur_layer === -1) {\n        return;\n    }\n    if (cur_layer === -1) {\n        const root_data = getLayerAndText(data_array.shift(), format);\n        cur_layer = root_data.layer || 0; // 一定的鲁棒性\n        cur_text = root_data.text || '未知数据';\n    }\n    const cur_node = {\n        id: cur_layer === 0 ? refer.ROOT_NODE_ID : md5('' + Date.now() + Math.random() + cur_text),\n        text: cur_text,\n        showChildren: true,\n        children: []\n    };\n    while (data_array.length > 0) {\n        const {layer, text} = getLayerAndText(data_array[0], format);\n        if (layer <= cur_layer) {\n            break;\n        }\n        data_array.shift();\n        if (layer) { // 排除掉无法匹配的情况\n            cur_node.children.push(buildNodeFromText(data_array, format, layer, text));\n        }\n    }\n    return cur_node;\n};\n\nconst copyNodeData = (format, target_node, source_node, is_root_node) => {\n    switch (format) {\n        case 'KM':\n            target_node.id = is_root_node ? refer.ROOT_NODE_ID : source_node.data.id;\n            target_node.text = source_node.data.text;\n            target_node.showChildren = source_node.data.expandState !== 'collapse';\n            target_node.children = source_node.children.map(child => copyNodeData(format, {}, child));\n            return target_node;\n        default:\n            return;\n    }\n};\n\nconst buildNodeFromJSON = (json, format) => {\n    switch (format) {\n        case 'RMF':\n            return JSON.parse(json);\n        case 'KM': {\n            let km_mindmap = JSON.parse(json);\n            return copyNodeData(format, {}, km_mindmap.root, true);\n        }\n        default:\n            return;\n    }\n};\n\nexport default (import_data, format) => {\n    let mindmap;\n    switch (format) {\n        case 'MD':\n        case 'TXT':\n            const data_array = import_data.split('\\n').filter(line => line);\n            mindmap = buildNodeFromText(data_array, format, -1);\n            break;\n        default:\n            mindmap = buildNodeFromJSON(import_data, format);\n            break;\n    }\n    return mindmap;\n}","import React, {useContext} from 'react';\nimport {css} from 'emotion';\nimport {context} from '../../../context';\nimport {setTitle} from '../../../context/reducer/global/actionCreator';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport {ROOT_NODE_ID} from '../../../statics/refer';\nimport mindmapParser from '../../../methods/mindmapParser';\nimport {ButtonSet, MainButton, Shortcut, Highlight, Annotation} from '../common/styledComponents';\n\nconst Open = ({handleClosePopup, handleDownload}) => {\n    const {global: {dispatch}} = useContext(context);\n    const {setMindmap} = useMindmap();\n\n    const handleOpenFile = () => {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = '.rmf,.km,.txt,.md';\n        input.addEventListener('change', event => {\n            const file = event.target.files[0],\n                file_name = file.name;\n            let dot_index = file_name.length - 1;\n            while (dot_index > 0 && file_name[dot_index] !== '.') {\n                dot_index--;\n            }\n            const format = file_name.slice(dot_index + 1).toUpperCase(),\n                title = file_name.slice(0, dot_index);\n            const file_reader = new FileReader();\n            file_reader.onload = event => {\n                const str = event.target.result;\n                const mindmap = mindmapParser(str, format);\n                if (mindmap && mindmap.id === ROOT_NODE_ID) {\n                    setMindmap(mindmap, true);\n                    dispatch(setTitle(title));\n                    handleClosePopup();\n                } else {\n                    alert('不是有效的思维导图文件');\n                }\n            };\n            file_reader.readAsText(file);\n        });\n        input.click();\n    };\n\n    return (<div>\n        <Highlight>打开其他文件后，当前思维导图的数据将丢失。</Highlight>\n        <Annotation>要保存当前数据，请将思维导图<Shortcut onClick={handleDownload}>下载至本地</Shortcut>。</Annotation>\n        <p className={sub_title}>支持打开格式：</p>\n        <ul className={list_wrapper}>\n            <li>RMind（.rmf）</li>\n            <li>百度脑图（.km）</li>\n            <li>Markdown（.md）</li>\n            <li>文本文件（.txt）</li>\n        </ul>\n        <ButtonSet>\n            <MainButton onClick={handleOpenFile}>打开文件</MainButton>\n            <button onClick={handleClosePopup}>取消</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default Open;\n\n// CSS\nconst sub_title = css`\nmargin: 20px 0 5px;\npadding-bottom: 8px;\nborder-bottom: 1px solid #dddddd;\n`;\n\nconst list_wrapper = css`\nmargin: 0;\npadding: 0;\nfont-size: 90%;\nlist-style: circle inside;\n\nli {\nline-height: 2em;\n}\n`;","import React from 'react';\nimport {css, cx} from 'emotion';\n\nconst ThemeListItem = ({theme, index, is_current, setTheme}) => {\n    const handleSetTheme = () => {\n        setTheme(index);\n    };\n\n    return (<li className={cx(wrapper, {[current_style]: is_current})} onClick={handleSetTheme}>\n        <div style={{backgroundColor: theme.ex}} />\n        <div style={{backgroundColor: theme.dark}} />\n        <div style={{backgroundColor: theme.main}} />\n        <div style={{backgroundColor: theme.light}} />\n    </li>);\n};\n\nexport default ThemeListItem;\n\n// CSS\n\nconst wrapper = css`\ndisplay: flex;\nbox-sizing: border-box;\nwidth: 47%;\nheight: 25px;\nmargin: 8px 0;\nborder-radius: 18px;\ncursor: pointer;\noverflow: hidden;\n\ndiv {\nflex: 1;\nz-index: -1;\n}\n`;\n\nconst current_style = css`\nbox-shadow: 0 0 0 4px #ffffff, 0 0 0 6px #000000; /* 两层阴影实现框选效果，也可用 inset 阴影 + border-color 做 */\n`;\n","import React, {useEffect} from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../../../customHooks/useTheme';\nimport {ButtonSet, Highlight} from '../../common/styledComponents';\nimport ThemeListItem from './ThemeListItem';\n\nconst Theme = ({handleClosePopup}) => {\n    const {theme_index, theme_list, setTheme} = useTheme();\n\n    useEffect(() => {\n        localStorage.setItem('theme_index', theme_index);\n    }, [theme_index]);\n\n    return (<div>\n        <Highlight>请选择主题：</Highlight>\n        <ul className={list_wrapper}>\n            {theme_list.map((theme, index) => <ThemeListItem key={theme.main} theme={theme} index={index}\n                                                             is_current={theme_index === index} setTheme={setTheme} />)}\n        </ul>\n        <ButtonSet>\n            <button onClick={handleClosePopup}>完成</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default Theme;\n\n// CSS\nconst list_wrapper = css`\ndisplay: flex;\njustify-content: space-between;\nflex-wrap: wrap;\npadding: 0;\nlist-style: none;\n`;","import React, {Suspense, lazy} from 'react';\nimport {css} from 'emotion';\nimport * as popupType from './common/popupType';\nimport {handlePropagation} from '../../methods/assistFunctions';\nimport New from './subComponents/New';\nimport Open from './subComponents/Open';\nimport Theme from './subComponents/Theme';\n\nconst getContentComponent = type => {\n    switch (type) {\n        case popupType.NEW:\n            return New;\n        case popupType.OPEN:\n            return Open;\n        case popupType.EXPORT:\n            return lazy(() => import('./subComponents/Export'));\n        case popupType.THEME:\n            return Theme;\n        default:\n            return;\n    }\n};\n\nconst Popup = ({type, handleClosePopup, handleDownload}) => {\n    const Content = getContentComponent(type);\n    return (<div className={wrapper} onClick={handlePropagation}>\n        <div className={content_wrapper}>\n            <i className={'zwicon-close-circle ' + close_button} onClick={handleClosePopup} />\n            <Suspense fallback={<></>}>\n                <Content handleClosePopup={handleClosePopup} handleDownload={handleDownload} />\n            </Suspense>\n        </div>\n        <div className={overlay} onClick={handleClosePopup} />\n    </div>);\n};\n\nexport default Popup;\n\n// CSS\nconst wrapper = css`\nposition: fixed;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\n`;\n\nconst content_wrapper = css`\ndisplay: flex;\nflex-direction: column;\nposition: absolute;\ntop:30%;\nleft:0;\nright:0;\nwidth: 400px;\nmargin: auto;\npadding: 40px 40px 20px;\nfont-size: 1rem;\nbackground-color: #ffffff;\nborder-radius: 20px;\nz-index: 1;\n`;\n\nconst close_button = css`\nposition: absolute;\ntop: 10px;\nright: 10px;\nfont-size: 25px;\nfont-weight: 700;\n\n&:active {\ntransform: scale(0.95)\n}\n`;\n\nconst overlay = css`\nposition: absolute;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\nbackground: #000000;\nopacity: 0.2;\n`;\n","export const NONE = 'none';\nexport const NEW = 'new';\nexport const OPEN = 'open';\nexport const EXPORT = 'export';\nexport const THEME = 'theme';","import React, { useState, useContext } from 'react';\nimport { css } from 'emotion';\nimport { context } from '../../context';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useHistory from '../../customHooks/useHistory';\nimport useZoom from '../../customHooks/useZoom';\nimport useMove from '../../customHooks/useMove';\nimport * as refer from '../../statics/refer';\nimport * as popupType from '../../components/Popup/common/popupType';\nimport { handlePropagation, downloadFile } from '../../methods/assistFunctions'; // 防止 Mindmap 中的选中状态由于冒泡被清除\nimport ToolButton from '../../components/ToolButton';\nimport MindmapTitle from '../../components/MindmapTitle';\nimport Popup from '../../components/Popup';\n\nconst Nav = () => {\n    const [popup, setPopup] = useState(popupType.NONE);\n    const { mindmap: { state: mindmap }, history: { state: history }, global: { state: { title } } } = useContext(context);\n    const { expandAll } = useMindmap();\n    const { zoomIn, zoomOut, zoomReset } = useZoom();\n    const { moveXY, moveReset } = useMove()\n    const { undoHistory, redoHistory } = useHistory();\n\n    const handleClosePopup = () => {\n        setPopup(popupType.NONE);\n    };\n\n    const handleNewFile = () => {\n        setPopup(popupType.NEW);\n    };\n\n    const handleDownload = () => {\n        const url = `data:text/plain,${encodeURIComponent(JSON.stringify(mindmap))}`;\n        downloadFile(url, `${title}.rmf`);\n    };\n\n    const handleOpenFile = () => {\n        setPopup(popupType.OPEN);\n    };\n\n    const handleExport = () => {\n        setPopup(popupType.EXPORT);\n    };\n\n    const handleTheme = () => {\n        setPopup(popupType.THEME);\n    };\n\n    const handleUndo = () => {\n        undoHistory();\n    };\n\n    const handleRedo = () => {\n        redoHistory();\n    };\n\n    const handleExpand = () => {\n        expandAll(refer.ROOT_NODE_ID);\n    };\n\n    const handleZoom = (zoom) => {\n        console.log('缩放', zoom ? zoom : '还原')\n        switch (zoom) {\n            case 'in':\n                zoomIn()\n                break;\n            case 'out':\n                zoomOut()\n                break;\n            default:\n                zoomReset()\n        }\n    }\n\n    const handleMove = (move) => {\n        console.log('移动', move ? move : '还原')\n        switch (move) {\n            case 'up':\n                moveXY(0,-5)\n                break;\n            case 'down':\n                moveXY(0,5)\n                break;\n            case 'left':\n                moveXY(-5,0)\n                break;\n            case 'right':\n                moveXY(5,0)\n                break;\n            default:\n                moveReset()\n        }\n    }\n\n    return (<nav className={wrapper}>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'add-item-alt'} onClick={handleNewFile}>新建</ToolButton>\n            <ToolButton icon={'folder-open'} onClick={handleOpenFile}>打开</ToolButton>\n            <ToolButton icon={'file-download'} onClick={handleDownload}>下载至本地</ToolButton>\n            <ToolButton icon={'duplicate'} onClick={handleExport}>导出</ToolButton>\n            <ToolButton icon={'palette'} onClick={handleTheme}>主题</ToolButton>\n            <ToolButton icon={'plus-circle'} onClick={() => handleZoom('in')}>放大</ToolButton>\n            <ToolButton icon={'minus-circle'} onClick={() => handleZoom('out')}>缩小</ToolButton>\n            <ToolButton icon={'rotate-left'} onClick={() => handleZoom()}>还原</ToolButton>\n        </section>\n        <section className={section}>\n            <MindmapTitle />\n        </section>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'rotate-left'} onClick={() => handleMove()}>还原</ToolButton>\n            <ToolButton icon={'arrow-left'} onClick={() => handleMove('left')}>左</ToolButton>\n            <ToolButton icon={'arrow-up'} onClick={() => handleMove('up')}>上</ToolButton>\n            <ToolButton icon={'arrow-down'} onClick={() => handleMove('down')}>下</ToolButton>\n            <ToolButton icon={'arrow-right'} onClick={() => handleMove('right')}>右</ToolButton>\n            <ToolButton icon={'undo'} disabled={history.undo.length === 0} onClick={handleUndo}>撤销</ToolButton>\n            <ToolButton icon={'redo'} disabled={history.redo.length === 0} onClick={handleRedo}>重做</ToolButton>\n            <ToolButton icon={'scale'} onClick={handleExpand}>展开所有节点</ToolButton>\n        </section>\n        {popup !== popupType.NONE &&\n            <Popup type={popup} handleClosePopup={handleClosePopup} handleDownload={handleDownload} />}\n    </nav>);\n};\n\nexport default Nav;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\njustify-content: space-between;\nposition: fixed;\ntop:0;\nleft:0;\nright:0;\nheight: 56px;\npadding: 0 50px;\nfont-size: 25px;\nbackground-color: #ffffff;\nbox-shadow: 0 0px 2px #aaaaaa;\nz-index: 10;\n`;\n\nconst section = css`\ndisplay: flex;\n`;","import * as refer from '../statics/refer';\n\nexport default (nodeStatus, mindmapHook, historyHook) => {\n    const {addChild, addSibling, editNode, deleteNode, toggleChildren, selectNode} = mindmapHook;\n\n    const handleKeyEventWithNode = event => {\n        switch (event.key.toUpperCase()) {\n            case 'TAB':\n                addChild(nodeStatus.cur_select);\n                break;\n            case 'ENTER':\n                event.preventDefault(); // 防止 enter 的点击行为\n                addSibling(nodeStatus.cur_select, nodeStatus.cur_node_info.parent.id);\n                break;\n            case 'F2':\n                editNode(nodeStatus.cur_select);\n                break;\n            case 'BACKSPACE':\n            case 'DELETE':\n                deleteNode(nodeStatus.cur_select, nodeStatus.cur_node_info.parent.id);\n                break;\n            case ' ':\n                event.preventDefault(); // 默认行为会导致画面移动，因此 prevent，下同\n                toggleChildren(nodeStatus.cur_select, !nodeStatus.cur_node_info.showChildren); // Boolean('false') === true\n                break;\n            case 'ARROWLEFT':\n                event.preventDefault();\n                if (nodeStatus.cur_node_info.parent === refer.ROOT_PARENT) {\n                    if (nodeStatus.cur_node_info.children.length > 3) {\n                        selectNode(nodeStatus.cur_node_info.children[Math.trunc(nodeStatus.cur_node_info.children.length / 2)].id);\n                    }\n                } else {\n                    if (!nodeStatus.cur_node_info.on_left) {\n                        selectNode(nodeStatus.cur_node_info.parent.id);\n                    } else if (nodeStatus.cur_node_info.children.length > 0) {\n                        selectNode(nodeStatus.cur_node_info.children[0].id);\n                    }\n                }\n                break;\n            case 'ARROWRIGHT':\n                event.preventDefault();\n                if (nodeStatus.cur_node_info.on_left) {\n                    selectNode(nodeStatus.cur_node_info.parent.id);\n                } else if (nodeStatus.cur_node_info.children.length > 0) {\n                    selectNode(nodeStatus.cur_node_info.children[0].id);\n                }\n                break;\n            case 'ARROWUP': {\n                event.preventDefault();\n                const cur_index = nodeStatus.cur_node_info.parent.children.findIndex(child => child.id === nodeStatus.cur_node_info.id);\n                if (cur_index > 0) {\n                    selectNode(nodeStatus.cur_node_info.parent.children[cur_index - 1].id);\n                }\n                break;\n            }\n            case 'ARROWDOWN': {\n                event.preventDefault();\n                const cur_index = nodeStatus.cur_node_info.parent.children.findIndex(child => child.id === nodeStatus.cur_node_info.id),\n                    last_index = nodeStatus.cur_node_info.parent.children.length - 1;\n                if (cur_index < last_index) {\n                    selectNode(nodeStatus.cur_node_info.parent.children[cur_index + 1].id);\n                }\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    return event => {\n        if (nodeStatus.cur_edit === '') {\n            const is_on_mac = navigator.platform.toUpperCase().startsWith('MAC');\n            const combine_key_pressed = is_on_mac ? event.metaKey : event.ctrlKey;\n            if (combine_key_pressed && event.key.toUpperCase() === 'Z') {\n                if (event.shiftKey) {\n                    historyHook.redoHistory();\n                } else {\n                    historyHook.undoHistory();\n                }\n            }\n        }\n        if (nodeStatus.cur_select !== '') {\n            try {\n                handleKeyEventWithNode(event); // 据说在 try 代码块中写大量语句会影响性能，因此包装为函数\n            } catch (e) {\n                alert('当前的节点信息存在问题，请重新选择节点');\n            }\n        }\n    };\n};","const mousemoveInfo = {\n    startX: 0,\n    startY: 0,\n}\n\nexport default (propHook, zoomRate,normalizeXY) => {\n    const { zoomIn, zoomOut, moveXY } = propHook;\n    const getWheelDelta = (e) => {\n        if (e.wheelDelta) {\n            return e.wheelDelta\n        } else {\n            return -e.wheelDelta * 40\n        }\n    }\n\n    const handleWhellEventWithkey = e => {\n\n        if (e.ctrlKey === true && e.wheelDelta) {\n            e.preventDefault()\n            e.stopPropagation()\n            getWheelDelta(e) > 0 ? zoomIn(e.clientX,e.clientY) : zoomOut(e.clientX,e.clientY)\n            return;\n        }\n\n        if (e.buttons === 1 && e.type === 'mousedown') {\n            mousemoveInfo.startX = e.clientX\n            mousemoveInfo.startY = e.clientY\n            return\n        }\n\n        if (e.altKey && e.buttons === 1) {\n            e.stopPropagation()\n            const { startX, startY } = mousemoveInfo;\n            const movedX = (e.clientX - startX);\n            const movedY = (e.clientY - startY);\n            moveXY(movedX / 10 / normalizeXY, movedY / 10)\n            mousemoveInfo.startX = e.clientX\n            mousemoveInfo.startY = e.clientY\n        }\n    };\n\n    return event => {\n        try {\n            handleWhellEventWithkey(event); // 据说在 try 代码块中写大量语句会影响性能，因此包装为函数\n        } catch (e) {\n            alert('移动或缩放功能异常',e);\n        }\n    };\n};","import * as actionTypes from './actionTypes';\n\nexport const toggelPanelShow = (isShow) => ({\n    type: actionTypes.TOGGLE_PANEL_SHOW,\n    data: {\n        isShow,\n    }\n});\n\n\n// export const openPanel = theme_index => ({\n//     type: actionTypes.OPEN_PANEL,    \n// });","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as editPanelAction from '../context/reducer/editPanel/actionCreator';\n\n\nconst useEditPanel = () => {\n    const {editPanel: {state:epState,dispatch: epDispatch}} = useContext(context);\n    return {\n        toggelPanelShow: (bool) => {\n            if(epState.isShow===bool){\n                return ;    \n            }\n            epDispatch(editPanelAction.toggelPanelShow(bool));\n        },\n        savePanel: (bool) => {\n            epDispatch(editPanelAction.toggelPanelShow(bool));\n        },\n    }\n};\n\nexport default useEditPanel;","import React from 'react';\nimport {css} from 'emotion';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport useEditPanel from '../../../customHooks/useEditPanel';\nimport {handlePropagation} from '../../../methods/assistFunctions';\nimport ToolButton from '../../ToolButton';\n\nconst Toolbar = ({layer, node, parent}) => {\n    const mindmapHook = useMindmap();\n    const editPanelHook=useEditPanel();\n\n    const handleAddChild = () => {\n        mindmapHook.addChild(node.id);\n        alert(\"Adding\")\n    };\n\n    const handleAddSibling = () => {\n        mindmapHook.addSibling(node.id, parent.id);\n        alert(\"Adding\")\n    };\n\n    const handleDeleteNode = () => {\n        mindmapHook.deleteNode(node.id, parent.id);\n        alert(\"Deleting\")\n    };\n\n    const handleEditNode = () => {\n        mindmapHook.editNode(node.id);\n    };\n\n    const handleToggleChildren = () => {\n        mindmapHook.toggleChildren(node.id, !node.showChildren);\n    };\n\n    const handleAddInfo=()=>{\n        mindmapHook.selectNode(node.id);\n        editPanelHook.toggelPanelShow(true);\n    }\n\n    return (<div className={wrapper} onClick={handlePropagation}>\n        <ToolButton icon={'git-commit'} onClick={handleAddChild}>添加子节点</ToolButton>\n        <ToolButton icon={'git-fork'} onClick={handleAddSibling} disabled={layer < 1}>添加兄弟节点</ToolButton>\n        <ToolButton icon={'delete'} onClick={handleDeleteNode} disabled={layer < 1}>删除</ToolButton>\n        <ToolButton icon={'edit-pencil'} onClick={handleEditNode}>编辑</ToolButton>\n        <ToolButton icon={'edit-pencil'} onClick={handleAddInfo}>添加备注</ToolButton>\n        <ToolButton icon={'split-v'} onClick={handleToggleChildren} disabled={layer < 1 || node.children.length === 0}>显隐子节点</ToolButton>\n    </div>);\n};\n\nexport default Toolbar;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nposition: absolute;\nbottom: calc(100% + 5px);\nleft:0;\nbackground-color: #ffffff;\nwidth: max-content;\nheight: 50px;\npadding: 0 8px;\nfont-size: 20px;\nbackground-color: #ffffff;\nborder-radius: 10px;\nbox-shadow: 5px 5px 10px #aaaaaa;\n`;","import React, {useEffect, useRef} from 'react';\nimport {css} from 'emotion';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport {handlePropagation} from '../../../methods/assistFunctions';\n\nconst InputDiv = ({node_id, children}) => {\n    const self = useRef();\n    const {changeText, selectNode} = useMindmap();\n\n    const handleKeydown = event => {\n        switch (event.key.toUpperCase()) {\n            case 'ESCAPE':\n                self.current.textContent = children;\n            case 'ENTER':\n                self.current.blur();\n                break;\n            default:\n                break;\n        }\n    };\n\n    const handleBlur = () => {\n        changeText(node_id, self.current.textContent);\n        selectNode(node_id);\n    };\n\n    useEffect(() => {\n        self.current.focus();\n        const selection = document.getSelection();\n        selection.selectAllChildren(self.current);\n    }, []);\n\n    return (<div className={wrapper} ref={self} contentEditable=\"true\" suppressContentEditableWarning=\"true\"\n                 onClick={handlePropagation} onKeyDown={handleKeydown} onBlur={handleBlur}>{children}</div>);\n};\n\nexport default InputDiv;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop: 0;\nbottom: 0;\nleft: 0;\nright: 0;\nwidth: fit-content;\nmin-width: 1em;\nmax-width: 10em;\nheight: fit-content;\nmargin: auto;\npadding: 10px;\ncolor: #333333;\nbackground-color: #ffffff;\nbox-shadow: 0 0 20px #aaaaaa;\nborder-radius: 5px;\noutline: none;\nz-index: 3;\nuser-select: text;\n`;","import React, { useState, useEffect } from 'react';\nimport marked from 'marked';\nimport './index.css'\n\nimport hljs from 'highlight.js'\nimport 'highlight.js/styles/github.css';\n\nmarked.setOptions({\n    renderer: new marked.Renderer(),\n    highlight: function (code) {\n        return hljs.highlightAuto(code).value;\n    },\n    pedantic: false,\n    gfm: false,\n    breaks: false,\n    sanitize: false,\n    smartLists: true,\n    smartypants: false,\n    xhtml: false\n});\n\nfunction MdPreview(props) {\n    const { mdtext='' } = props;\n\n    //   const [example, setExample] = useState('initialValue');\n    //   useEffect(() => {\n    //     // 使用浏览器的 API 更新页面标题\n    //     // document.title = `You clicked count times`;\n    //   });\n    useEffect(() => {        \n        document.querySelectorAll('pre code').forEach((block) => {\n          hljs.highlightBlock(block);\n        });      \n      },[mdtext]);\n\n    return (\n        <div className=\"MdPreview\">\n            <i className=\"zwicon-note\" style={{ fontSize: 20 }}></i>\n\n            <div className=\"MdPreview-Content\" dangerouslySetInnerHTML={{ __html: marked(mdtext) }} />\n        </div>\n    )\n}\n\nexport default MdPreview;","import React, {useEffect, useRef, useContext} from 'react';\nimport {css, cx} from 'emotion';\nimport {context} from '../../context';\nimport useMindmap from \"../../customHooks/useMindmap\";\nimport {getNodeInfo} from '../../context/reducer/nodeStatus/actionCreator';\nimport * as refer from '../../statics/refer';\nimport {handlePropagation} from '../../methods/assistFunctions';\nimport Toolbar from './subComponents/Toolbar';\nimport InputDiv from './subComponents/InputDiv';\nimport MdPreview from '../mdPreview';\n\nconst Node = ({layer, node, parent, node_refs, on_left}) => {\n    const self = useRef();\n    const {nodeStatus: {state: nodeStatus, dispatch: nDispatch}, editPanel: {state:epState}} = useContext(context);\n    const mindmapHook = useMindmap();\n\n\n    const handleSelectNode = () => {\n        mindmapHook.selectNode(node.id, true);\n    };\n\n    const handleEditNode = () => {\n        mindmapHook.editNode(node.id);\n    };\n\n    const handleToggleChildren = () => {\n        mindmapHook.toggleChildren(node.id, !node.showChildren);\n        mindmapHook.clearNodeStatus(); // 避免出现当前选择的节点被隐藏后仍然可以操作的情况\n    };\n\n    useEffect(() => {\n        node_refs.add(self);\n        return () => {\n            node_refs.delete(self);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (nodeStatus.cur_select === node.id) {\n            self.current.scrollIntoView({behavior: 'smooth', block: 'center', inline: 'center'});\n            nDispatch(getNodeInfo(node, parent, on_left));\n        }\n    }, [nodeStatus.cur_select, node]);    \n\n    // 为避免事件冒泡导致干扰，点击事件放在了 dropArea div，最外层 Node div 用于阻止冒泡\n    return (<div\n        className={cx(common_style, specific_style[layer < 3 ? layer : 3], {[seleted_style]: nodeStatus.cur_select === node.id})}\n        draggable={layer > 0 && nodeStatus.cur_edit !== node.id}\n        data-tag={on_left ? refer.LEFT_NODE : refer.RIGHT_NODE}\n        data-parent={parent.id}\n        data-show-children={node.showChildren}\n        id={node.id}\n        ref={self}\n        onClick={handlePropagation}>\n        {nodeStatus.cur_edit === node.id &&\n        <InputDiv node_id={node.id}>{node.text}</InputDiv>}\n        <div className={drop_area} data-tag={refer.DROP_AREA} onClick={handleSelectNode} onDoubleClick={handleEditNode} />\n        <p>{node.text} {node.info && <MdPreview mdtext={node.info}/>}</p>\n        {(layer > 0 && node.children.length > 0) &&\n        <button className={cx(toggle_button, (on_left ? button_left : button_right))} onClick={handleToggleChildren}>{node.showChildren ? '-' : '+'}</button>}\n        {(nodeStatus.cur_select === node.id && nodeStatus.select_by_click) && !epState.isShow &&\n        <Toolbar layer={layer} node={node} parent={parent} />}\n    </div>);\n};\n\nexport default Node;\n\n// CSS\nconst style_selected_border = `\nbox-shadow: 0 0 0 3px #ffffff, 0 0 0 6px var(${refer.THEME_EX}); /* 双层阴影实现选中框 */\n`;\n\nconst common_style = css`\nposition: relative;\nmin-width: 10px;\nmax-width: 200px;\nmargin: 20px 40px;\npadding: 15px;\nbackground-color: #ffffff;\nborder: 1px solid var(${refer.THEME_MAIN});\nborder-radius: 15px;\ncursor: pointer;\n\np {\nmin-height: 18px; /* 当 p 中没有内容时撑起元素 */\nmargin: 0;\nline-height: 1.5em;\noverflow-wrap: break-word;\n}\n\n&:hover {\n${style_selected_border}\n}\n\n&.ondrag {\nbackground-color: var(${refer.THEME_EX});\np {\ncolor: #ffffff;\n}\n}\n`;\n\nconst specific_style = [ // div&用于提高 CSS 权重\n    css`\ndiv& {\npadding: 15px 20px;\ncolor: #ffffff;\nfont-size: 120%;\nfont-weight: 700;\nbackground-color: var(${refer.THEME_DARK});\nborder:2px solid var(${refer.THEME_EX});\n}\n    `,\n    css`\ndiv& {\nbackground-color: var(${refer.THEME_LIGHT});\n}\n    `,\n    css`\ndiv& {\npadding: 10px 15px;\n}\n    `,\n    css`\ndiv& {\npadding: 0 15px;\nborder: none;\np {\nfont-size: 90%;\n}\n}\n    `\n];\n\nconst seleted_style = css`\nz-index: 1; /* 提高 Node 高度，防止被遮挡 */\n${style_selected_border}\n`;\n\n// 兼有防止文字被选中的功能\nconst drop_area = css`\nposition: absolute;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\n`;\n\nconst toggle_button = css`\nposition: absolute;\ntop:0;\nbottom: 0;\nwidth: 20px;\nheight: 20px;\nmargin: auto 0;\npadding: 0;\ntext-align: center;\nbackground-color: #ffffff;\nborder: 1px solid #cccccc;\nborder-radius: 50%;\noutline: none;\n`;\n\nconst button_left = css`\nleft: -15px;\n`;\n\nconst button_right = css`\nright: -15px;\n`;","import React from 'react';\nimport {css, cx} from 'emotion';\nimport Node from '../Node';\n\nconst SubNode = ({layer, node, node_refs, parent, on_left}) => {\n    return (<div className={cx(wrapper, {[left_style]: on_left})}>\n        <Node layer={layer} node={node} node_refs={node_refs} parent={parent} on_left={on_left} />\n        <div>\n            {node.showChildren && node.children.map(sub_node => <SubNode key={sub_node.id} layer={layer + 1}\n                                                                         node={sub_node} node_refs={node_refs}\n                                                                         parent={node} on_left={on_left} />)}\n        </div>\n    </div>);\n};\n\nexport default SubNode;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nalign-items: center;\n`;\n\nconst left_style = css`\nflex-direction: row-reverse;\n`;","import React, {useEffect, useRef} from 'react';\nimport {css} from 'emotion';\nimport {ROOT_PARENT} from '../../statics/refer';\nimport Node from '../Node';\nimport SubNode from '../SubNode';\n\nconst RootNode = ({layer, node, node_refs}) => {\n    const root_node = useRef();\n\n    const total = node.children.length,\n        half = total > 3 ? Math.trunc(total / 2) : total;\n\n    // 载入时使根节点居中。暂时没发现除了多包一层 div 之外更好的解决方法\n    useEffect(() => {\n        root_node.current.scrollIntoView({block: 'center', inline: 'center'});\n    }, []);\n\n    return (<div className={wrapper}>\n        <div>\n            {node.showChildren && node.children.slice(half).map(sub_node => <SubNode\n                key={sub_node.id}\n                layer={layer + 1}\n                node={sub_node}\n                node_refs={node_refs}\n                parent={node} on_left={true} />)}\n        </div>\n        <div ref={root_node}>\n            <Node layer={0} node={node} node_refs={node_refs} parent={ROOT_PARENT} />\n        </div>\n        <div>\n            {node.showChildren && node.children.slice(0, half).map(sub_node => <SubNode\n                key={sub_node.id}\n                layer={layer + 1}\n                node={sub_node}\n                node_refs={node_refs}\n                parent={node}\n                on_left={false} />)}\n        </div>\n    </div>);\n};\n\nexport default RootNode;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nalign-items: center;\nwidth: max-content; /* max-content 才能保证正确读取布局 */\n`;","import * as refer from '../statics/refer';\n\nconst drawBezier = (ctx, from_x, from_y, to_x, to_y) => {\n    ctx.moveTo(from_x, from_y);\n    ctx.bezierCurveTo(from_x, to_y, 0.9 * to_x + 0.1 * from_x, to_y, to_x, to_y);\n};\n\nconst drawLine = (ctx, node, map) => {\n    const {id: parent_id, children} = node;\n    if (children.length > 0) {\n        const [parent_x_left, parent_x_right, parent_y] = map.get(parent_id);\n\n        children.forEach(child => {\n            const child_data = map.get(child.id);\n            if (child_data) {\n                const [child_x_left, child_x_right, child_y, child_tag] = child_data;\n                if (child_tag === refer.LEFT_NODE) {\n                    drawBezier(ctx, parent_x_left, parent_y, child_x_right, child_y);\n                } else {\n                    drawBezier(ctx, parent_x_right, parent_y, child_x_left, child_y);\n                }\n                drawLine(ctx, child, map);\n            }\n        })\n    }\n};\n\nexport const drawLineCanvas = (ctx, theme, mindmap, map) => {\n    ctx.beginPath();\n    ctx.lineWidth = '2';\n    ctx.strokeStyle = theme.main;\n    drawLine(ctx, mindmap, map);\n    ctx.stroke();\n    ctx.closePath();\n};\n\nexport const drawDragCanvas = (ctx, theme, child_id, parent_offset, child_offset, child_left_of_parent) => {\n    const virtual_rect_width = 50,\n        virtual_rect_height = 20;\n    ctx.beginPath();\n    ctx.strokeStyle = theme.main;\n    ctx.lineWidth = '2';\n    ctx.setLineDash([5, 5]);\n    let parent_x,\n        parent_y = (parent_offset.top + parent_offset.bottom) / 2,\n        child_x,\n        child_y = (child_offset.top + child_offset.bottom) / 2;\n    if (child_left_of_parent) {\n        parent_x = parent_offset.left;\n        child_x = child_offset.right;\n        ctx.strokeRect(child_x - virtual_rect_width, child_y - virtual_rect_height / 2, virtual_rect_width, virtual_rect_height);\n    } else {\n        parent_x = parent_offset.right;\n        child_x = child_offset.left;\n        ctx.strokeRect(child_x, child_y - virtual_rect_height / 2, virtual_rect_width, virtual_rect_height);\n    }\n    drawBezier(ctx, parent_x, parent_y, child_x, child_y);\n    ctx.stroke();\n    ctx.closePath();\n};","import * as refer from '../statics/refer';\nimport { findNode } from './assistFunctions';\nimport { drawDragCanvas } from './drawCanvas';\n\nconst getDomOffset = dom => {\n    const left = dom.offsetLeft,\n        right = left + dom.offsetWidth,\n        top = dom.offsetTop,\n        bottom = top + dom.offsetHeight;\n    return { left, right, top, bottom };\n};\n\nexport default (mindmap, drag_canvas, container, theme, mindmapHook,zoom,drag) => {\n    const { moveNode } = mindmapHook;\n\n    let node_id, parent_id, target_id, is_sibling,\n        children, children_offset_left, children_offset_right, children_offset_vertical,\n        parent_offset, parent_is_root,\n        container_left, container_top,container_width,container_height,\n        in_drop_area;\n\n    const resetVariables = () => {\n        node_id = '';\n        parent_id = '';\n        target_id = '';\n        is_sibling = false;\n\n        children = [];\n        children_offset_left = [];\n        children_offset_right = [];\n        children_offset_vertical = [];\n\n        parent_offset = undefined;\n        parent_is_root = false;\n\n        container_left = container.scrollLeft;\n        container_top = container.scrollTop - 56;\n        container_width = container.offsetWidth;\n        container_height = container.offsetHeight;\n\n        in_drop_area = false;\n    };\n\n    const handleContainerScroll = (e) => {\n        \n        container_left = container.scrollLeft;\n        container_top = container.scrollTop - 56; // 56 是 container（Main 组件）顶部 margin 值        \n    };\n\n    return [\n        \n        {\n            type: 'dragstart',\n            listener: event => {\n                resetVariables();\n                container.addEventListener('scroll', handleContainerScroll);\n                if (event.target && (event.target.dataset.tag === refer.LEFT_NODE || event.target.dataset.tag === refer.RIGHT_NODE)) {\n                    node_id = event.target.id;\n                    parent_id = event.target.dataset.parent;\n                    const parent = findNode(mindmap, parent_id);\n                    parent_is_root = parent === mindmap;\n                    parent_offset = getDomOffset(document.getElementById(parent_id));\n                    children[0] = parent.children.map(child => child.id);\n                    let children_offset = [];\n                    children_offset[0] = children[0].map(node_id => getDomOffset(document.getElementById(node_id)));\n                    if (parent_is_root && mindmap.children.length > 3) {\n                        const half = Math.trunc(mindmap.children.length / 2);\n                        children = [children[0].slice(0, half), children[0].slice(half)];\n                        children_offset = [children_offset[0].slice(0, half), children_offset[0].slice(half)];\n                    }\n                    children_offset_left = children_offset.map(each => Math.min(...each.map(offset => offset.left)));\n                    children_offset_right = children_offset.map(each => Math.max(...each.map(offset => offset.right)));\n                    children_offset_vertical = children_offset.map(each => each.map(offset => [offset.top, offset.bottom]).reduce((flat_arr, cur) => flat_arr.concat(cur), []));\n                }\n            }\n        },\n        {\n            type: 'drag',\n            listener: event => {\n                const ctx = drag_canvas.getContext('2d');\n                ctx.clearRect(0, 0, drag_canvas.width, drag_canvas.height);\n                const total = children.length;\n                const moveX=-(container_width*drag.x/100)\n                const moveY=-(container_height*drag.y/100)\n                const mouse_x = (event.x + container_left)/zoom+moveX,\n                    mouse_y = (event.y + container_top)/zoom+moveY;\n                for (let i = 0; i < total; i++) {\n                    if (!in_drop_area && mouse_x > children_offset_left[i] && mouse_x < children_offset_right[i]) {\n                        let child_offset = { left: children_offset_left[i], right: children_offset_right[i] };\n                        const child_left_of_parent = i === 1 || (!parent_is_root && (document.getElementById(node_id).dataset.tag === refer.LEFT_NODE)); // i = 1，即出现双侧拖拽时，左侧发生的拖拽 child_left_of_parent 必然为 true\n                        const last_index = children_offset_vertical[i].length - 1;\n                        if (mouse_y > children_offset_vertical[i][0] - 200 && mouse_y < children_offset_vertical[i][0]) { // 优化体验，实际是显示的 2 倍\n                            child_offset.top = children_offset_vertical[i][0] - 50;\n                            child_offset.bottom = children_offset_vertical[i][0];\n                            drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                            target_id = children[i][0];\n                            is_sibling = true;\n                            return;\n                        }\n                        for (let j = 2; j < last_index + 1; j += 2) {\n                            if (mouse_y > children_offset_vertical[i][j - 1] && mouse_y < children_offset_vertical[i][j]) {\n                                child_offset.top = children_offset_vertical[i][j - 1];\n                                child_offset.bottom = children_offset_vertical[i][j];\n                                drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                                target_id = children[i][j / 2];\n                                is_sibling = true;\n                                return;\n                            }\n                        }\n                        if (mouse_y > children_offset_vertical[i][last_index] && mouse_y < children_offset_vertical[i][last_index] + 200) {\n                            child_offset.top = children_offset_vertical[i][last_index];\n                            child_offset.bottom = children_offset_vertical[i][last_index] + 50;\n                            drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                            target_id = children[i + 1] && children[i + 1][0];\n                            is_sibling = true;\n                            return;\n                        }\n                    }\n                }\n            }\n        },\n        {\n            type: 'dragover',\n            listener: event => {\n                event.preventDefault();\n            }\n        },\n        {\n            type: 'dragenter',\n            listener: event => {\n                if (event.target && event.target.dataset.tag === refer.DROP_AREA) {\n                    event.target.parentNode.classList.add('ondrag');\n                    target_id = event.target.parentNode.id;\n                    is_sibling = false;\n                    in_drop_area = true;\n                }\n            }\n        },\n        {\n            type: 'dragleave',\n            listener: event => {\n                if (event.target && event.target.dataset.tag === refer.DROP_AREA) {\n                    event.target.parentNode.classList.remove('ondrag');\n                    target_id = '';\n                    is_sibling = false;\n                    in_drop_area = false;\n                }\n            }\n        },\n        {\n            type: 'drop',\n            listener: event => {\n                event.target.parentNode.classList.remove('ondrag');\n                if (target_id !== '' && target_id !== node_id && target_id !== parent_id) {\n                    moveNode(node_id, target_id, parent_id, is_sibling);\n                }\n            }\n        },\n        {\n            type: 'dragend',\n            listener: () => {\n                const ctx = drag_canvas.getContext('2d');\n                ctx.clearRect(0, 0, drag_canvas.width, drag_canvas.height);\n                container.removeEventListener('scroll', handleContainerScroll);\n            }\n        }\n    ];\n}","import React, { useState, useEffect, useRef, useContext } from 'react';\nimport { css } from 'emotion';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useTheme from '../../customHooks/useTheme';\nimport getDragEvents from '../../methods/getDragEvents';\nimport { context } from '../../context'\nimport * as refer from '../../statics/refer';\n\nconst DragCanvas = ({ parent_ref, container_ref, mindmap }) => {\n    const self = useRef();\n    const [flag, setFlag] = useState(0);\n\n    const { theme } = useTheme();\n\n    const mindmapHook = useMindmap();\n\n    const { global: { state: gState } } = useContext(context);\n    const {zoom,x,y}=gState\n\n    const handleWindowResize = () => {\n        setFlag(Date.now());\n    };\n\n    useEffect(() => {\n        window.addEventListener('resize', handleWindowResize);\n        return () => {\n            window.removeEventListener('resize', handleWindowResize);\n        }\n    }, []);\n\n    useEffect(() => {\n        const handleDrag = getDragEvents(mindmap, self.current, container_ref.current, theme, mindmapHook,zoom,{x,y});\n        handleDrag.forEach(event => document.querySelector(`#${refer.MINDMAP_ID}`).addEventListener(event.type, event.listener));\n        return () => {\n            handleDrag.forEach(event => document.querySelector(`#${refer.MINDMAP_ID}`).removeEventListener(event.type, event.listener));\n        }\n    }, [mindmap, theme,zoom,x,y]);\n\n    useEffect(() => {\n        const dom = self.current;\n        dom.width = parent_ref.current.offsetWidth;\n        dom.height = parent_ref.current.offsetHeight;\n    }, [mindmap, flag, gState.zoom]);\n\n    return (<canvas ref={self} className={wrapper} />);\n};\n\nexport default DragCanvas;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop:0;\nleft:0;\nz-index: -1;\n`;","import React, {useState, useEffect, useRef, useContext} from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../customHooks/useTheme';\nimport {context} from '../../context'\nimport {drawLineCanvas} from '../../methods/drawCanvas';\n\nconst LineCanvas = ({parent_ref, mindmap, node_refs}) => {\n    const self = useRef();\n    const [flag, setFlag] = useState(0);\n\n    const {theme} = useTheme();\n    const {global:{state:gState}}=useContext(context);\n\n    const handleWindowResize = (e) => {\n        setFlag(Date.now());        \n    };\n\n    useEffect(() => {\n        window.addEventListener('resize', handleWindowResize);\n        return () => {\n            window.removeEventListener('resize', handleWindowResize);\n        }\n    }, []);\n\n    useEffect(() => {\n        const dom = self.current;\n        dom.width = parent_ref.current.offsetWidth;\n        dom.height = parent_ref.current.offsetHeight; // 重新设置 canvas 大小，也兼具清除画板的作用\n        const map = new Map(Array.from(node_refs).map(ref => [ref.current.id, [(ref.current.offsetLeft), (ref.current.offsetLeft + ref.current.offsetWidth), (ref.current.offsetTop + 0.5 * ref.current.offsetHeight), ref.current.dataset.tag]]));\n        const ctx = dom.getContext('2d');\n        drawLineCanvas(ctx, theme, mindmap, map);\n    }, [mindmap, theme, flag, gState.zoom]);\n\n    return (<canvas ref={self} className={wrapper} />);\n};\n\nexport default LineCanvas;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop:0;\nleft:0;\nz-index: -2;\n`;","import React, { useEffect, useContext, useRef, useMemo, useState } from 'react';\nimport { css } from 'emotion';\nimport * as refer from '../../statics/refer';\nimport { context } from '../../context/';\nimport { setHistory } from '../../context/reducer/history/actionCreator';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useHistory from '../../customHooks/useHistory';\nimport getKeydownEvent from '../../methods/getKeydownEvent';\nimport getMouseWheelEvent from '../../methods/getMouseWheelEvent';\nimport RootNode from '../../components/RootNode';\nimport DragCanvas from '../../components/DragCanvas';\nimport LineCanvas from '../../components/LineCanvas';\nimport useZoom from '../../customHooks/useZoom';\nimport useMove from '../../customHooks/useMove';\nimport { debounce } from '../../methods/assistFunctions';\n\nconst node_refs = new Set();\n\nconst Mindmap = ({ container_ref }) => {\n    const self = useRef();\n    const { mindmap: { state: root_node }, nodeStatus: { state: nodeStatus }, history: { dispatch: hDispatch }, global: { state: gState } } = useContext(context);\n\n    const historyHook = useHistory();\n    const mindmapHook = useMindmap();\n    const zoomHook = useZoom();\n    const moveHook = useMove()\n    const { clearNodeStatus } = mindmapHook;\n    const [FLAG, setFLAG] = useState(0)\n\n    const mindmap_json = useMemo(() => JSON.stringify(root_node), [root_node]); // 如果 root_node 没有 JSON.stringify，使用按键操作时有时会连续两次触发 useEffect，目前没查出来为什么。利用 useMemo 避免重复触发\n\n    const handleResize = () => {\n        setFLAG(Date.now())\n    }\n\n    useEffect(() => {\n        const handleKeydown = getKeydownEvent(nodeStatus, mindmapHook, historyHook);\n        window.addEventListener('keydown', handleKeydown);\n        return () => {\n            window.removeEventListener('keydown', handleKeydown);\n        }\n    }, [nodeStatus]);\n\n    useEffect(() => {\n        window.addEventListener('click', clearNodeStatus);\n        return () => {\n            window.removeEventListener('click', clearNodeStatus);\n        }\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        }\n    }, [])\n\n    useEffect(() => {\n        const normalizeXY = container_ref.current.clientWidth / container_ref.current.clientHeight\n        const handleMouseWheel = getMouseWheelEvent(zoomHook, gState.zoom)\n        const handleMapMove = getMouseWheelEvent(moveHook, gState.zoom, normalizeXY)\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('wheel', handleMouseWheel);\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousemove', debounce(handleMapMove, 4));\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousedown', handleMapMove)\n        return () => {\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).removeEventListener('wheel', handleMouseWheel);\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousemove', debounce(handleMapMove, 4));\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousedown', handleMapMove);\n        }\n    }, [FLAG]);\n\n    useEffect(() => {\n        localStorage.setItem('mindmap', mindmap_json);\n        hDispatch(setHistory(mindmap_json, nodeStatus.cur_select || nodeStatus.cur_edit));\n    }, [mindmap_json]);\n\n    return (\n        <div\n            className={wrapper}\n            ref={self}\n            style={{ zoom: gState.zoom, left: gState.x + 'vw', top: gState.y + 'vh' }}\n            id={refer.MINDMAP_ID}\n            draggable={false}>\n            <RootNode key={root_node.id} layer={0} node={root_node} node_refs={node_refs} />\n            <DragCanvas parent_ref={self} container_ref={container_ref} mindmap={root_node} />\n            <LineCanvas parent_ref={self} mindmap={root_node} node_refs={node_refs} />\n        </div>\n    );\n};\n\nexport default Mindmap;\n\n// CSS\nconst wrapper = css`\nposition: relative;\nwidth: fit-content;\npadding: 30vh 30vw;\n`;","import React, { useState, useEffect } from 'react';\n\nfunction MdEditor(props) {\n    const { propText } = props;\n\n    const [text, setText] = useState(propText);\n\n    useEffect(() => {\n        setText(propText)\n    }, [propText]);\n    \n    const onChange = (e) => {\n        setText(e.target.value)\n    }\n\n    const onBlur = () => {\n        console.log('备注：', text)\n        props.onBlur && props.onBlur(text)\n    }\n\n\n\n    return (\n        <div className={props.className || ''}>\n            <textarea style={textarea} onChange={onChange} onBlur={onBlur} value={text} />\n        </div>\n    )\n}\n\nexport default MdEditor;\n\n\nconst textarea = {\n    width: '100%',\n    height: '100%',\n    resize: 'none'\n}","import React, {useContext, useEffect} from 'react';\nimport {css} from 'emotion';\nimport useEditPanel from '../../customHooks/useEditPanel';\nimport useMindmap from '../../customHooks/useMindmap';\nimport {context} from '../../context'\nimport MdEditor from '../../components/mdEditor';\n\nconst EditPanel = () => {\n    // const self = useRef();\n    \n    const {editPanel: {state:epState},nodeStatus:{state:nState}} =useContext(context)\n    const {cur_node_info:{info='',text,id}}=nState\n    \n    const mindmapHook=useMindmap()\n    const editPanleHook=useEditPanel();\n    \n    if(!epState.isShow){\n        return null;\n    }\n    \n    return (        \n        <div className={show} onClick={e=>e.stopPropagation()} onKeyDown={e=>e.stopPropagation()}>\n            当前编辑节点：{text || '无'}        \n\n            <i className=\"zwicon-close\" style={close} onClick={()=>editPanleHook.toggelPanelShow(false)}></i>                        \n            <MdEditor \n                className={mdEditor} \n                propText={info}\n                onBlur={(value)=> id && mindmapHook.editNodeInfo(id,value)}\n            />                       \n            {/* <Button type=\"primary\" onClick={()=>mindmapHook.editNodeInfo(id,inputVal)}>保存</Button>\n            <Button type=\"primary\" onClick={()=>editPanleHook.toggelPanelShow(false)}>关闭</Button> */}            \n        </div>\n    );\n};\n\nexport default EditPanel;\n\n// CSS\nconst show = css`\nheight: 500px;\nwidth: 300px;\ntop: 20px;\nright: 40px;\nmargin: 56px 0 0;\noverflow: auto;\nposition: fixed;\n//z-index: 10;\nborder: 2px solid #eeee;\nborder-radius: 10px;\nbackground: #fff;\nbackground:rgba(255,255,255,1);\nbox-shadow:0px 2px 12px 0px rgba(0,0,0,0.16);\npadding:20px 10px;\n`;\n\nconst close={    \n    fontSize:20,\n    position: 'absolute',\n    cursor:'pointer',\n    right: '10px',\n    top: '5px',\n}\n\nconst mdEditor=css`\n    margin-top:20px;\n    width:295px;\n    height:460px;\n`","import React, { useRef } from 'react';\nimport { css } from 'emotion';\nimport Mindmap from '../Mindmap';\nimport EditPanel from '../EditPanel';\nimport * as refer from '../../statics/refer';\n\nconst Main = () => {\n    const self = useRef();\n\n    return (<main ref={self} className={wrapper} id={refer.MINDMAP_MAIN}>\n        <Mindmap container_ref={self} />\n        <EditPanel />\n    </main>);\n};\n\nexport default Main;\n\n// CSS\nconst wrapper = css`\nheight: calc(100vh - 56px);\nmargin: 56px 0 0;\noverflow: hidden;\n`;","import React from 'react';\nimport Provider from './context/';\nimport ThemeProvider from './features/ThemeProvider'\nimport Nav from './features/Nav';\nimport Main from './features/Main'\n\nconst App = () => {\n    return (<Provider>\n        <ThemeProvider>\n            <Nav />\n            <Main />\n        </ThemeProvider>\n    </Provider>);\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'normalize.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import {ROOT_NODE_ID} from './refer';\n\nexport default {\n    id: ROOT_NODE_ID,\n    text: \"主题\",\n    showChildren: true,\n    children: [\n        {\n            id: \"Sub1\",\n            text: \"分支1\",\n            showChildren: true,\n            children: []\n        },\n        {\n            id: \"Sub2\",\n            text: \"分支2\",\n            showChildren: true,\n            children: []\n        },\n        {\n            id: \"Sub3\",\n            text: \"分支3\",\n            showChildren: true,\n            children: []\n        }\n    ]\n}","export const TOGGLE_PANEL_SHOW = 'editPanel/togglePanelShow';","import * as actionTypes from './actionTypes';\nimport defaultMindmap from '../../../statics/defaultMindmap';\nimport {findNode, deepCopy, setShowChildrenTrue} from '../../../methods/assistFunctions';\n\nexport const defaultValue_mindmap = JSON.parse(localStorage.getItem('mindmap')) || defaultMindmap;\n\nexport default (mindmap, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_CHILDREN: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            if (node_found.children.length > 0 && node_found !== new_mindmap) {\n                Object.assign(node_found, action.data.node);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.ADD_CHILD: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            node_found.children.push(action.data.node);\n            return new_mindmap;\n        }\n        case actionTypes.ADD_SIBLING: {\n            const new_mindmap = deepCopy(mindmap);\n            if (action.data.parent_id) {\n                const node_found = findNode(new_mindmap, action.data.parent_id);\n                const insert_index = node_found.children.findIndex(node => node.id === action.data.node_id) + 1;\n                node_found.children.splice(insert_index, 0, action.data.node);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.MOVE_NODE: {\n            const new_mindmap = deepCopy(mindmap),\n                parent = findNode(new_mindmap, action.data.parent_id),\n                node_index = parent.children.findIndex(node => node.id === action.data.node_id),\n                node_copy = parent.children[node_index];\n            parent.children.splice(node_index, 1);\n            if (action.data.is_sibling) {\n                const target_index = parent.children.findIndex(node => node.id === action.data.target_id) + 1 || parent.children.length + 1;\n                parent.children.splice(target_index - 1, 0, node_copy);\n            } else {\n                const target_node = findNode(new_mindmap, action.data.target_id);\n                target_node.children.push(node_copy);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.CHANGE_TEXT: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            Object.assign(node_found, action.data.node);\n            return new_mindmap;\n        }\n        case actionTypes.DELETE_NODE: {\n            const new_mindmap = deepCopy(mindmap);\n            if (action.data.parent_id) {\n                const node_found = findNode(new_mindmap, action.data.parent_id);\n                const delete_index = node_found.children.findIndex(node => node.id === action.data.node_id);\n                node_found.children.splice(delete_index, 1);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.EXPAND_ALL: {\n            const new_mindmap = deepCopy(mindmap);\n            const node_found = findNode(new_mindmap, action.data.node_id);\n            setShowChildrenTrue(node_found);\n            return new_mindmap;\n        }\n        case actionTypes.SET_MINDMAP: {\n            return action.data.mindmap;\n        }\n        default:\n            return mindmap;\n    }\n};","import * as actionTypes from './actionTypes';\n\nexport const defaultValue_nodeStatus = {\n    cur_select: '',\n    select_by_click: false,\n    cur_edit: '',\n    cur_node_info: {}\n};\n\nexport default (nodeStatus, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECT:\n            if (nodeStatus.cur_select === action.data.cur_select) { // 避免 cur_select 未变更时 info 被清空\n                delete action.data.cur_node_info;\n            }\n            return {...nodeStatus, ...action.data};\n        case actionTypes.SET_EDIT:\n        case actionTypes.CLEAR_ALL:\n        case actionTypes.GET_NODE_INFO:\n            return {...nodeStatus, ...action.data};\n        default:\n            return nodeStatus;\n    }\n};","import * as actionTypes from './actionTypes';\nimport {deepCopy} from '../../../methods/assistFunctions';\n\nexport const defaultValue_history = {\n    undo: [],\n    redo: [],\n    last_snapshot: null\n};\n\nexport default (history, action) => {\n    switch (action.type) {\n        case actionTypes.SET_HISTORY: {\n            const new_history = deepCopy(history);\n            if (new_history.last_snapshot) {\n                if (new_history.undo.length > 0 && new_history.undo[new_history.undo.length - 1].mindmap === action.data.mindmap) {\n                    new_history.redo.unshift(new_history.last_snapshot);\n                    new_history.undo.pop();\n                } else if (new_history.redo.length > 0 && new_history.redo[0].mindmap === action.data.mindmap) {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo.shift();\n                } else {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo = [];\n                }\n            }\n            new_history.last_snapshot = action.data;\n            return new_history;\n        }\n        case actionTypes.CLEAR_HISTORY: {\n            return defaultValue_history;\n        }\n        default:\n            return history;\n    }\n};","import * as actionTypes from './actionTypes';\nimport * as refer from '../../../statics/refer';\nimport { deepCopy } from '../../../methods/assistFunctions';\nimport { debug } from 'util';\n\nexport const defaultValue_global = {\n    title: localStorage.getItem('title') || refer.DEFAULT_TITLE,\n    theme_index: Number(localStorage.getItem('theme_index')) || 0,\n    theme_list: [\n        { main: \"#eda938\", light: \"#f4cc87\", dark: \"#e79021\", ex: \"#ce7529\", assist: \"#1980da\" },\n        { main: \"#ff4c26\", light: \"#ffcabc\", dark: \"#e83f1d\", ex: \"#c12a0f\", assist: \"#0e95ac\" },\n        { main: \"#50b843\", light: \"#c3e5bd\", dark: \"#28ab17\", ex: \"#038b00\", assist: \"#790595\" },\n        { main: \"#2d99d7\", light: \"#e2f5ff\", dark: \"#2786c3\", ex: \"#2375af\", assist: \"#ca6c27\" },\n        { main: \"#b347d2\", light: \"#e4c0ef\", dark: \"#a623c9\", ex: \"#9621c3\", assist: \"#009000\" },\n        { main: \"#555555\", light: \"#e9e9e9\", dark: \"#434343\", ex: \"#262626\", assist: \"#860314\" }\n    ],\n    zoom: 1,\n    x:0,\n    y:0,\n};\n\nconst ZOOM_STEP=0.1;\nconst MOVE_STEP=0.1;\n\nconst preventMinValue=(obj,key,min)=>{\n    \n    if(obj[key]<=min){\n        obj[key]=min\n    }\n}\n\nexport default (global, action) => {\n    switch (action.type) {\n        case actionTypes.SET_TITLE:\n        case actionTypes.SET_THEME:\n            return Object.assign(deepCopy(global), action.data);\n        case actionTypes.ZOOM_IN: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom += ZOOM_STEP;\n            return newGlobal;\n        }\n        case actionTypes.ZOOM_OUT: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom -= ZOOM_STEP;\n            preventMinValue(newGlobal,'zoom', 0.3)\n            return newGlobal;\n        }\n        case actionTypes.ZOOM_RESET: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom = 1;\n            return newGlobal;\n        }        \n        case actionTypes.MOVE_XY: {\n            const newGlobal = deepCopy(global)\n            newGlobal.x+=action.data.x/newGlobal.zoom;\n            newGlobal.y+=action.data.y/newGlobal.zoom;\n            return newGlobal;\n        }        \n        case actionTypes.MOVE_RESET: {\n            const newGlobal = deepCopy(global)\n            newGlobal.x=0;\n            newGlobal.y=0;\n            return newGlobal;\n        }\n        case actionTypes.MOVE_XY_WHEN_ZOOM:{\n            const newGlobal = deepCopy(global)\n            newGlobal.x=0;\n            newGlobal.x=0;\n            return newGlobal;\n        }\n        default:\n            return global;\n    }\n};","import * as actionTypes from './actionTypes';\n// import defaultMindmap from '../../../statics/defaultMindmap';\nimport {deepCopy} from '../../../methods/assistFunctions';\n\nexport const defaultValue_editPanel = {\n    isShow:false,\n    nodeId:''\n};\n\nexport default (panel, action) => {\n    switch (action.type) {        \n        case actionTypes.TOGGLE_PANEL_SHOW: \n            const newPanel = deepCopy(panel);\n            newPanel.isShow=action.data.isShow\n            return newPanel        \n        default:\n            return panel;\n    }\n};","import React, {useReducer} from 'react';\nimport mindmapReducer, {defaultValue_mindmap} from './reducer/mindmap/';\nimport nodeStatusReducer, {defaultValue_nodeStatus} from './reducer/nodeStatus';\nimport historyReducer, {defaultValue_history} from './reducer/history';\nimport globalReducer, {defaultValue_global} from './reducer/global';\nimport editPanelReducer,{defaultValue_editPanel} from './reducer/editPanel';\n\nconst context = React.createContext({});\n\nconst WrappedProvider = props => {\n    const [mState, mDispatch] = useReducer(mindmapReducer, defaultValue_mindmap);\n    const [nState, nDispatch] = useReducer(nodeStatusReducer, defaultValue_nodeStatus);\n    const [hState, hDispatch] = useReducer(historyReducer, defaultValue_history);\n    const [gState, gDispatch] = useReducer(globalReducer, defaultValue_global);\n    const [epState, epDispatch] = useReducer(editPanelReducer, defaultValue_editPanel);\n    const combined = {\n        mindmap: {\n            state: mState,\n            dispatch: mDispatch\n        },\n        nodeStatus: {\n            state: nState,\n            dispatch: nDispatch\n        },\n        history: {\n            state: hState,\n            dispatch: hDispatch\n        },\n        global: {\n            state: gState,\n            dispatch: gDispatch\n        },\n        editPanel: {\n            state: epState,\n            dispatch: epDispatch\n        }\n    };\n\n    return (<context.Provider value={combined}>\n        {props.children}\n    </context.Provider>)\n};\n\nexport {context};\nexport default WrappedProvider;","import * as actionTypes from './actionTypes';\n\nexport const setHistory = (mindmap, cur_node) => ({\n    type: actionTypes.SET_HISTORY,\n    data: mindmap ? ({mindmap, cur_node}) : null\n});\n\nexport const clearHistory = () => ({type: actionTypes.CLEAR_HISTORY});"],"sourceRoot":""}